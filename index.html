<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RankStudio - Advanced Generator</title>
    <link href="https://fonts.cdnfonts.com/css/minecraftia" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #0d0f12;
            --panel-bg: #16181d;
            --accent: #0080ff;
            --text-white: #ffffff;
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-white);
            font-family: 'Segoe UI', sans-serif;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #app {
            width: 100%;
            max-width: 1000px;
            background: var(--panel-bg);
            border-radius: 8px;
            padding: 25px;
            border: 1px solid #2d2f35;
        }

        /* Preview oben platziert */
        .preview-header {
            background-color: #0b0c0e;
            border: 1px solid #2d2f35;
            height: 140px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            margin-bottom: 25px;
        }

        canvas {
            image-rendering: pixelated;
            transform: scale(4); /* Scharfer Pixel-Look */
        }

        .controls-main {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .input-group { margin-bottom: 15px; }

        label {
            display: block;
            font-size: 12px;
            color: #8e9297;
            margin-bottom: 5px;
        }

        input[type="text"] {
            width: 100%;
            background: #1e2126;
            border: 1px solid #333;
            padding: 10px;
            color: white;
            border-radius: 4px;
            outline: none;
        }

        .gradient-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .btn-action {
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            color: white;
            cursor: pointer;
            font-weight: 600;
            margin-right: 10px;
        }

        .btn-blue { background: #007bff; }
        .btn-add { background: #28a745; width: 100%; margin-top: 10px; }
    </style>
</head>
<body>

<div id="app">
    <div class="preview-header">
        <canvas id="rankCanvas"></canvas>
    </div>

    <div class="controls-main">
        <div>
            <div class="input-group">
                <label>Rang Name (Klein- & Großschreibung möglich)</label>
                <input type="text" id="rName" value="trat">
            </div>
            <div class="input-group">
                <label>Text Farbe (Hex)</label>
                <input type="text" id="tColor" value="#FFFFFF">
            </div>
            <div class="input-group">
                <label>Schatten Farbe</label>
                <input type="text" id="sColor" value="#222222AA">
            </div>
        </div>

        <div>
            <label>Hintergrund Farben (Verlauf)</label>
            <div id="colorInputs" class="gradient-list">
                <input type="text" class="bg-stop" value="#d400ff" placeholder="Farbe 1">
                <input type="text" class="bg-stop" value="#8000ff" placeholder="Farbe 2">
            </div>
            <button class="btn-action btn-add" onclick="addColorField()">+ Farbe hinzufügen</button>
        </div>
    </div>

    <div style="margin-top: 30px; text-align: center;">
        <button class="btn-action btn-blue" style="padding: 15px 60px;" onclick="downloadImage()">Download PNG</button>
    </div>
</div>

<script>
    const canvas = document.getElementById('rankCanvas');
    const ctx = canvas.getContext('2d');

    function addColorField() {
        const container = document.getElementById('colorInputs');
        const input = document.createElement('input');
        input.type = 'text';
        input.className = 'bg-stop';
        input.value = '#000000';
        input.oninput = draw;
        container.appendChild(input);
        draw();
    }

    function draw() {
        const name = document.getElementById('rName').value; // Keine .toUpperCase() mehr!
        const tCol = document.getElementById('tColor').value;
        const sCol = document.getElementById('sColor').value;
        const bgStops = Array.from(document.getElementsByClassName('bg-stop')).map(i => i.value);

        // Minecraft Font
        ctx.font = '8px "Minecraftia"';
        const textWidth = Math.ceil(ctx.measureText(name).width);
        
        // Kompaktes Format wie bei MaceMeme
        canvas.width = textWidth + 6;
        canvas.height = 10;

        // Mehrfarbiger Hintergrund (Gradient)
        const grad = ctx.createLinearGradient(0, 0, 0, canvas.height);
        bgStops.forEach((color, index) => {
            grad.addColorStop(index / (bgStops.length - 1), color);
        });

        ctx.fillStyle = grad;
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Schatten Rendering
        ctx.fillStyle = sCol;
        ctx.fillText(name, 3.5, 8.5);

        // Haupttext Rendering
        ctx.fillStyle = tCol;
        ctx.fillText(name, 3, 8);
    }

    function downloadImage() {
        const link = document.createElement('a');
        link.download = 'rank.png';
        link.href = canvas.toDataURL();
        link.click();
    }

    document.querySelectorAll('input').forEach(i => i.oninput = draw);
    document.fonts.ready.then(draw);
</script>

</body>
</html>
